#### Young/Old区优化

ry25-26 好好理解吸收

- 预估内存使用模型，高峰期系统运行压力
- 合理调整Survivor区，尽量不要触发动态年龄判断或分配担保进Old区
- 根据YGC频率，合理降低对象进入Old区的年龄，尽快让长期存活的对象进入Old区，如@Service、@Controller的业务系统逻辑组件



#### JVM优化是优化什么

JVM性能问题就是内存分配、参数设置不合理，导致对象频繁进入老年代，触发Old区GC，导致系统频繁卡顿

优化就是优化这个，减少GC对系统的影响



#### 大内存机器GC选择

大内存机器使用普通的收集器会导致STW时间过长，一般使用G1，自定义期望停顿时间，这会导致YGC频率，而YGC频率高一些对系统影响并不会很大







## 监控命令

#### jinfo

打印系统、JVM配置信息



#### jstack

打印线程栈信息



#### jstat

jstat -gc PID



##### 各参数含义

S0C -- S0区大小

S1C -- S1区大小

S0U -- S0区当前对象大小

S1U -- S1区当前对象大小

EC -- Eden区大小

EU -- Eden区当前对象大小

OC -- Old区大小

OU -- Old区当前对象大小

MC -- Method区大小

MU -- Method区当前对象大小

YGC -- YGC总次数

YGCT -- YGC总耗时

FGC -- FGC总次数

FGCT -- FGC总耗时

GCT -- 所有GC总耗时



##### 新生代对象增长速度

jstat -gc PID 1000 10

连续打印10次，每次间隔1000ms



##### YGC触发频率

根据Young区对象增长速度和Young区空间推测



##### YGC平均耗时

YGC总时间 / YGC总次数



##### YGC进入Old区的对象

统计每次YGC之后S1区和Old区新增的对象



##### FGC触发频率

根据Old区对象增长速度和Old区空间推测



##### FGC平均耗时

FGC总时间 / FGC总次数



#### jmap

生成堆转储文件，打印对象内存占用情况