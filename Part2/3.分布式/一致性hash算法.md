## 使用场景

一致性hash算法常用于分布式存储领域

分库分表场景，根据某个字段值，使用下哈希算法路由到某个库

Redis集群，写一个key时，也需要把key根据哈希算法算出来，分摊到各个库









## 实现方案

#### 简单的hash算法

- `m = hash(o) % n`

  m是机器编号，o是对象，n是机器数量

  根据hash函数算出对象o的哈希值，与机器数量取模

- 缺点：对扩缩容不友好，增减机器数量时，数据需重新取模计算。在分布式缓存场景会降低缓存命中率，导致缓存击穿

  解决方案可以使用**成倍扩容**来解决，3个节点变6个，但是就造成了资源浪费



#### 一致性hash算法

圆环 + 虚拟节点

https://mp.weixin.qq.com/s/sLjgpLcbNHFVh71WP8PFCg