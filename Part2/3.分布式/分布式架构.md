### 国内分布式架构发展历史

早些年：大厂都各自研发相关组件

几年前：大部分公司都用阿里开源的Dubbo+Zookeeper技术栈，其他组件没有统一（或者根本不用），大厂还是自研

近几年：中小企业里绝大部分用SpringCloud技术栈，一部分还是Dubbo+Zookeeper，小部分中大厂基于Dubbo自研，大厂还是自研

现在：有的公司还是用老的Netflix技术栈，有的开始推行SpringCloud Alibaba + 国内开源组件配合使用。国内各大公司都开源很多组件，携程的Apollo啥的，组成一套全新的以国内开源技术为核心的微服务体系

![](.\pic\微服务技术架构.png)



### 微服务

- 目的：分散功能，个体自治，独立部署，模块解耦，快速排查问题，升级和出bug不影响其它模块，是一种软件架构风格

### 分布式

- 目的：分散压力，一个业务分拆多个子业务，部署在不同的服务器上，也就是以分散功能的形式表现出来，是一种软件架构形式。分布式需要做好事务管理

### 集群

- 目的：分散压力，将分布式拆出来的每个子业务部署到多个服务器，集群是堆机器，倾向于软件实施阶段，是一种物理形式。集群模式需要做好session共享

### 分布式和微服务的区别：

- 设计初衷不同，分布式是分散压力，微服务是分散能力
- 分布式要部署在不同的服务器上，微服务则可能部署在一个服务器上
- 到后来作用差不多了，就可能只有部署形式的不同

### 分布式和集群的区别：

- 分布式是开发阶段的软件架构形式，集群是实施阶段的物理形式
- 分布式是提高单个任务的执行效率，集群是提高单位时间执行任务数
- 分布式和集群都是为了分散压力，只是分布式是以分散功能的形式表现出来，而集群是以堆机器的形式实现的

### 单机到微服务架构演变

>  一个单体项目 =>
>
>  多个单体项目之间进行远程服务调用（SOA + RPC），基于webservice / Dubbo+ZK  =>
>
>  微服务：面向 需求（订单服务）或者面向技术（文件下载服务、音频视频服务）的维度拆分，粒度比上一阶段更小

拆服务都是凭经验，没人能拆的很精准，所以招架构师都要看行业

![](D:\Learning\Gunners-Java\Part2\3.分布式\pic\SpringCloud架构.png)

- Nginx是管流量分发的网关，Gateway是处理业务逻辑的网关。
  Nginx单机能扛的并发量，要根据平均每个请求的数据包大小来计算。单机所能分配的带宽不高，单机性能不足，所以一般都是做Nginx集群，做高可用

- 啥时候要做SpringCloud？模块多、并发量高

- 两个等级

  服务拆不拆：模块多拆，拆完就得服务调用，Dubbo只能干这个，针对不同服务来做负载均衡

  拆完用不用微服务：都用SpringCloud了，Dubbo也成为其中一个组件了

- dubbo核心组件是远程服务调用

- dubbo的monitor相当于actuator+admin

