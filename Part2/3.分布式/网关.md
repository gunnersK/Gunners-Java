## 网关的作用

#### 动态路由

对于分布式系统，让前端/客户端去记住每个服务实例，然后直接去调服务实例的接口，还要做负载均衡，显然不现实

这就可以在所有服务实例之前做一层网关，前端直接把请求发给网关，由网关把请求动态均匀地路由给对应的服务实例

而且新上线服务，或者服务增减机器，网关都可以自动热感知

这就是动态路由



#### 灰度发布

灰度是在服务上线新功能前，先让一部分线上流量打进来，测试下服务是否正常

可以先把新功能的代码更新到一部分服务实例上，然后使用网关把一部分线上流量放给这部分实例，观察运行情况

没问题了再把新代码更新到剩下服务实例，正式上线



#### 授权认证

在网关层对所有需要鉴权的请求进行统一认证，避免每个服务都要单独进行鉴权



#### 性能监控

可以监控每个接口的耗时、成功率、QPS



#### 系统日志



#### 数据缓存



#### 限流熔断

在网关层也可以做请求的限流







## 技术选型

Kong、Zuul、Nginx+Lua、Gateway、自研网关

Kong -- Nginx中一个基于Lua写的模块

Zuul -- 基于Java开发，核心功能简单，灰度、限流、路由等功能都需要二次开发，高并发能力不强，但可以直接把控**Java**源码做自定义开发

Nginx（Kong、Nginx+Lua） -- 高并发能力很强，只需少数机器

自研网关 -- 基于Netty和Servlet做

其实不一定要用网关，对于规模不大的项目，可以在Nginx配置好每个服务对应的实例地址，也就是写死，再做下负载均衡，达到动态路由的功能。但是对于服务上下线，服务增减就不太灵活

