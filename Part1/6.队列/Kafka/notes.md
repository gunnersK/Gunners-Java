- AKF

- broker选举controller时会用到zk

- 消费者组

  组间隔离，一个分区可以给多个组消费，重复利用

- offset

  早期Kafka将offset直接维护在ZK中，但ZK是分布式协调工具，同时用来存储数据性能差，不适合进行频繁高并发读写操作，就出现了一个过渡方案，将offset放第三方，比如Redis/MySQL等

  现在Kafka自带了一个虚拟topic，将offset维护在其中

- 指定同一个key的消息会发送到同一个partition   `但是这样能顺序消费嘛？不太懂`



#### 消费方式

- Kafka消费方式也有拉取和推送两种

  推送是server主动推送，如果consumer消费不过来，会导致网卡打满 `谁的网卡`

  可以切换为拉取方式，让consumer自主按需拉取server数据

#### 消费粒度

即按条消费，还是按批消费

- 单线程消费：按顺序单条处理，offset递增，相对比较浪费CPU、网卡资源，但是能更精确控制进度
- 多线程消费：多线程处理业务，将整个批次的事务环节用一个线程处理，做到批次要么成功要么失败，较少对DB压力，和提交offset的频率压力，更多利用CPU、网卡资源，力度较粗

按条消费还是按批消费，单线程还是多线程，要根据实际情况权衡