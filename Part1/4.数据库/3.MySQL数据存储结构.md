数据页每一行数据都有行格式，可在建表时指定，或者后续修改

每行除了每个字段的值以外，还包含很多额外信息

每行数据会连续的挤在一起



#### 数据行

变长字段在行头倒序排长度

null值在行头倒序用bit指定是否为null

变长字段若为null，则不指定长度，加入null值行头的bit中，bit必须为8的倍数，高位补0

读取一行数据就是根据行头变长字段以及null值bit去识别数据的

每行会有40bit的数据头，描述这行数据

真实数据

每行的真实数据部分会加入一些隐藏字段

行溢出的任何类型字段用20字节的指针指向其他数据页，用链表连起来，称为溢出页



#### 数据页

文件头：38字节

数据页头：56字节

最大最小记录：26字节

数据行：不固定

空闲区域：不固定

数据页目录：不固定

文件尾部：8字节

缓存页和数据页一一对应，在磁盘上就是数据页，加载进BP就是缓存页

`数据页剩余空间放不下一个数据行是不是就产生碎片了？`



#### 表空间

表空间 = n组数据区

1组数据区 = 256数据区 = 256MB

1数据区(extent) = 64数据页 = 1MB

1数据页 = n数据行 = 16KB

extent组头结构见31

<img src=".\pic\表空间结构.png" style="zoom: 67%; float:left" />



数据页是固定大小的，所以在磁盘中有固定的起始和结束位置，刷盘时根据始末位置直接把老的数据页覆盖掉就行

redolog顺序读写

数据文件随机读写

IOPS：每秒执行磁盘读写操作次数

响应延迟：磁盘每次随机读写操作的响应延迟

