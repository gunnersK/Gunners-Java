- hash算法、寻址算法的优化

- 如何解决hash冲突

- 扩容、rehash过程，rehash算法优化

 

## 构造方法

若new时指定容量值，会自动使用他最接近的2的整数次幂值去初始化容量







## hash算法

#### 计算hash

```java
// jdk源码
static final int hash(Object key) {
    int h;
    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```

把hashCode二进制右移（>>>）16位，再与原值进行异或运算

> 异或运算：相同得0，相反得1
>
> 位移运算符：
>
> ```<<``` 乘2
>
> ```>>``` 除2
>
> ```>>>```无符号右移，空位0补齐



#### 寻址算法

把hash值跟数组长度 - 1再进行与运算（&），即：```(n - 1) & hash```，得到数组下标

这样做性能比直接%取模性能高，减少哈希碰撞



**不彻底理解为何移16位再异或和（n-1）&运算为何会减少哈希碰撞**



